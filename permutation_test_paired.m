% Script generated by Brainstorm (10-Aug-2023)

% Input files
sFiles = {...
    '1-Rec/@intra/timefreq_average_230804_0942.mat', ...
    '1-Rec/@intra/timefreq_average_230804_0943.mat', ...
    '1-Rec/@intra/timefreq_average_230804_0946.mat', ...
    '1-Rec/@intra/timefreq_average_230804_0947.mat', ...
    '1-Rec/@intra/timefreq_average_230804_0949.mat', ...
    '1-Rec/@intra/timefreq_average_230804_1335.mat'};
sFiles2 = {...
    '2-Ada/@intra/timefreq_average_230804_0948.mat', ...
    '2-Ada/@intra/timefreq_average_230804_0949.mat', ...
    '2-Ada/@intra/timefreq_average_230804_0950.mat', ...
    '2-Ada/@intra/timefreq_average_230804_0951.mat', ...
    '2-Ada/@intra/timefreq_average_230804_0953.mat', ...
    '2-Ada/@intra/timefreq_average_230804_1336.mat'};

% Start a new report
bst_report('Start', sFiles);

% Process: Perm wilcoxon paired  [0.000s,2.996s 2-45Hz]          H0:(A=B), H1:(A<>B)
sFiles = bst_process('CallProcess', 'process_test_permutation2p', sFiles, sFiles2, ...
    'timewindow',     [0, 2.99609375], ...
    'freqrange',      [2, 45], ...
    'rows',           '', ...
    'isabs',          0, ...
    'avgtime',        0, ...
    'avgrow',         0, ...
    'avgfreq',        0, ...
    'matchrows',      1, ...
    'iszerobad',      1, ...
    'Comment',        '', ...
    'test_type',      'wilcoxon_paired', ...  % Wilcoxon signed-rank test W = sum(sign(A-B) * tiedrank(abs(A-B)))
    'randomizations', 1000, ...
    'tail',           'two');  % Two-tailed

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

% Delete temporary files
% gui_brainstorm('EmptyTempFolder');

